/**
 * Date Picker Component
 * Version: 1.3.0
 * 
 * A comprehensive date picker with calendar view, range selection, month/year navigation,
 * localization support, and full accessibility features.
 *
 * Features:
 * - Single date and date range selection
 * - Inline and dropdown modes
 * - Month/year navigation
 * - Today indicator
 * - Disabled dates
 * - Min/max date constraints
 * - Keyboard navigation (Arrow keys, Enter, Space, Home, End, Page Up/Down)
 * - Dark mode support
 * - WCAG 2.1 AAA compliant
 * - Responsive mobile layout
 * - Multiple localization support
 */

@layer components {
  /* ========================================
     Base Date Picker Container
     ======================================== */
  .aa-datepicker {
    position: relative;
    display: inline-block;
    font-family: var(--adlaire-font-family-base);
    font-size: var(--adlaire-font-size-base);
    line-height: var(--adlaire-line-height-base);
    color: var(--adlaire-color-text-primary);
  }

  /* ========================================
     Input Trigger
     ======================================== */
  .aa-datepicker__input {
    display: inline-flex;
    align-items: center;
    gap: var(--adlaire-space-2);
    width: 100%;
    min-width: 240px;
    padding: var(--adlaire-space-2) var(--adlaire-space-3);
    font-size: var(--adlaire-font-size-base);
    line-height: var(--adlaire-line-height-base);
    color: var(--adlaire-color-text-primary);
    background-color: var(--adlaire-color-background);
    border: var(--adlaire-border-width-default) solid var(--adlaire-color-border-default);
    border-radius: var(--adlaire-border-radius-base);
    transition: all var(--adlaire-transition-fast) var(--adlaire-easing-ease-in-out);
    cursor: pointer;
  }

  .aa-datepicker__input:hover {
    border-color: var(--adlaire-color-primary);
  }

  .aa-datepicker__input:focus {
    outline: none;
    border-color: var(--adlaire-color-primary);
    box-shadow: 0 0 0 3px var(--adlaire-color-focus-ring);
  }

  .aa-datepicker__input:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    background-color: var(--adlaire-color-neutral-100);
  }

  .aa-datepicker__input-icon {
    flex-shrink: 0;
    width: 1.25rem;
    height: 1.25rem;
    color: var(--adlaire-color-text-secondary);
  }

  .aa-datepicker__input-text {
    flex: 1;
  }

  .aa-datepicker__input-text--placeholder {
    color: var(--adlaire-color-text-tertiary);
  }

  /* ========================================
     Calendar Dropdown
     ======================================== */
  .aa-datepicker__dropdown {
    position: absolute;
    top: calc(100% + var(--adlaire-space-2));
    left: 0;
    z-index: var(--adlaire-z-dropdown);
    display: none;
    min-width: 320px;
    padding: var(--adlaire-space-4);
    background-color: var(--adlaire-color-background);
    border: var(--adlaire-border-width-default) solid var(--adlaire-color-border-default);
    border-radius: var(--adlaire-border-radius-lg);
    box-shadow: var(--adlaire-shadow-lg);
  }

  .aa-datepicker__dropdown--open {
    display: block;
  }

  .aa-datepicker__dropdown--top {
    top: auto;
    bottom: calc(100% + var(--adlaire-space-2));
  }

  .aa-datepicker__dropdown--right {
    left: auto;
    right: 0;
  }

  /* Inline mode */
  .aa-datepicker--inline .aa-datepicker__dropdown {
    position: static;
    display: block;
    box-shadow: none;
    border: none;
    padding: 0;
  }

  /* ========================================
     Calendar Header
     ======================================== */
  .aa-datepicker__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--adlaire-space-4);
    gap: var(--adlaire-space-2);
  }

  .aa-datepicker__nav-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 2rem;
    height: 2rem;
    padding: 0;
    color: var(--adlaire-color-text-secondary);
    background-color: transparent;
    border: none;
    border-radius: var(--adlaire-border-radius-base);
    cursor: pointer;
    transition: all var(--adlaire-transition-fast) var(--adlaire-easing-ease-in-out);
  }

  .aa-datepicker__nav-button:hover {
    background-color: var(--adlaire-color-neutral-100);
    color: var(--adlaire-color-text-primary);
  }

  .aa-datepicker__nav-button:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--adlaire-color-focus-ring);
  }

  .aa-datepicker__nav-button:disabled {
    opacity: 0.4;
    cursor: not-allowed;
  }

  .aa-datepicker__current-date {
    flex: 1;
    text-align: center;
    font-weight: var(--adlaire-font-weight-semibold);
    font-size: var(--adlaire-font-size-base);
    color: var(--adlaire-color-text-primary);
  }

  .aa-datepicker__month-year-selector {
    display: inline-flex;
    gap: var(--adlaire-space-2);
  }

  .aa-datepicker__month-select,
  .aa-datepicker__year-select {
    padding: var(--adlaire-space-1) var(--adlaire-space-2);
    font-size: var(--adlaire-font-size-sm);
    font-weight: var(--adlaire-font-weight-semibold);
    color: var(--adlaire-color-text-primary);
    background-color: transparent;
    border: var(--adlaire-border-width-default) solid var(--adlaire-color-border-default);
    border-radius: var(--adlaire-border-radius-base);
    cursor: pointer;
    transition: all var(--adlaire-transition-fast) var(--adlaire-easing-ease-in-out);
  }

  .aa-datepicker__month-select:hover,
  .aa-datepicker__year-select:hover {
    border-color: var(--adlaire-color-primary);
  }

  .aa-datepicker__month-select:focus,
  .aa-datepicker__year-select:focus {
    outline: none;
    border-color: var(--adlaire-color-primary);
    box-shadow: 0 0 0 2px var(--adlaire-color-focus-ring);
  }

  /* ========================================
     Calendar Grid
     ======================================== */
  .aa-datepicker__calendar {
    width: 100%;
  }

  .aa-datepicker__weekdays {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: var(--adlaire-space-1);
    margin-bottom: var(--adlaire-space-2);
  }

  .aa-datepicker__weekday {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 2rem;
    font-size: var(--adlaire-font-size-xs);
    font-weight: var(--adlaire-font-weight-semibold);
    color: var(--adlaire-color-text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .aa-datepicker__days {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: var(--adlaire-space-1);
  }

  /* ========================================
     Day Cells
     ======================================== */
  .aa-datepicker__day {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 2.5rem;
    font-size: var(--adlaire-font-size-sm);
    color: var(--adlaire-color-text-primary);
    background-color: transparent;
    border: var(--adlaire-border-width-default) solid transparent;
    border-radius: var(--adlaire-border-radius-base);
    cursor: pointer;
    transition: all var(--adlaire-transition-fast) var(--adlaire-easing-ease-in-out);
    position: relative;
  }

  .aa-datepicker__day:hover:not(:disabled):not(.aa-datepicker__day--disabled) {
    background-color: var(--adlaire-color-primary-light);
    border-color: var(--adlaire-color-primary);
  }

  .aa-datepicker__day:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--adlaire-color-focus-ring);
    z-index: 1;
  }

  /* States */
  .aa-datepicker__day--other-month {
    color: var(--adlaire-color-text-tertiary);
  }

  .aa-datepicker__day--today {
    font-weight: var(--adlaire-font-weight-bold);
    border-color: var(--adlaire-color-primary);
  }

  .aa-datepicker__day--selected {
    color: #ffffff;
    background-color: var(--adlaire-color-primary);
    border-color: var(--adlaire-color-primary);
  }

  .aa-datepicker__day--selected:hover {
    background-color: var(--adlaire-color-primary-hover);
    border-color: var(--adlaire-color-primary-hover);
  }

  .aa-datepicker__day--in-range {
    background-color: var(--adlaire-color-primary-light);
    border-radius: 0;
  }

  .aa-datepicker__day--range-start,
  .aa-datepicker__day--range-end {
    color: #ffffff;
    background-color: var(--adlaire-color-primary);
    border-color: var(--adlaire-color-primary);
  }

  .aa-datepicker__day--range-start {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  }

  .aa-datepicker__day--range-end {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }

  .aa-datepicker__day--disabled {
    color: var(--adlaire-color-text-disabled);
    background-color: transparent;
    cursor: not-allowed;
    opacity: 0.5;
  }

  .aa-datepicker__day:disabled {
    color: var(--adlaire-color-text-disabled);
    cursor: not-allowed;
    opacity: 0.5;
  }

  /* ========================================
     Calendar Footer
     ======================================== */
  .aa-datepicker__footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: var(--adlaire-space-4);
    padding-top: var(--adlaire-space-3);
    border-top: var(--adlaire-border-width-default) solid var(--adlaire-color-border-default);
    gap: var(--adlaire-space-2);
  }

  .aa-datepicker__today-button {
    padding: var(--adlaire-space-2) var(--adlaire-space-3);
    font-size: var(--adlaire-font-size-sm);
    font-weight: var(--adlaire-font-weight-medium);
    color: var(--adlaire-color-primary);
    background-color: transparent;
    border: var(--adlaire-border-width-default) solid var(--adlaire-color-primary);
    border-radius: var(--adlaire-border-radius-base);
    cursor: pointer;
    transition: all var(--adlaire-transition-fast) var(--adlaire-easing-ease-in-out);
  }

  .aa-datepicker__today-button:hover {
    background-color: var(--adlaire-color-primary-light);
  }

  .aa-datepicker__today-button:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--adlaire-color-focus-ring);
  }

  .aa-datepicker__clear-button {
    padding: var(--adlaire-space-2) var(--adlaire-space-3);
    font-size: var(--adlaire-font-size-sm);
    font-weight: var(--adlaire-font-weight-medium);
    color: var(--adlaire-color-text-secondary);
    background-color: transparent;
    border: var(--adlaire-border-width-default) solid var(--adlaire-color-border-default);
    border-radius: var(--adlaire-border-radius-base);
    cursor: pointer;
    transition: all var(--adlaire-transition-fast) var(--adlaire-easing-ease-in-out);
  }

  .aa-datepicker__clear-button:hover {
    background-color: var(--adlaire-color-neutral-100);
    border-color: var(--adlaire-color-text-secondary);
  }

  .aa-datepicker__clear-button:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--adlaire-color-focus-ring);
  }

  /* ========================================
     Size Variants
     ======================================== */
  /* Small */
  .aa-datepicker--sm .aa-datepicker__input {
    padding: var(--adlaire-space-1) var(--adlaire-space-2);
    font-size: var(--adlaire-font-size-sm);
    min-width: 200px;
  }

  .aa-datepicker--sm .aa-datepicker__dropdown {
    min-width: 280px;
    padding: var(--adlaire-space-3);
  }

  .aa-datepicker--sm .aa-datepicker__day {
    height: 2rem;
    font-size: var(--adlaire-font-size-xs);
  }

  .aa-datepicker--sm .aa-datepicker__weekday {
    height: 1.5rem;
  }

  /* Large */
  .aa-datepicker--lg .aa-datepicker__input {
    padding: var(--adlaire-space-3) var(--adlaire-space-4);
    font-size: var(--adlaire-font-size-lg);
    min-width: 280px;
  }

  .aa-datepicker--lg .aa-datepicker__dropdown {
    min-width: 360px;
    padding: var(--adlaire-space-5);
  }

  .aa-datepicker--lg .aa-datepicker__day {
    height: 3rem;
    font-size: var(--adlaire-font-size-base);
  }

  .aa-datepicker--lg .aa-datepicker__weekday {
    height: 2.5rem;
    font-size: var(--adlaire-font-size-sm);
  }

  /* ========================================
     Range Mode
     ======================================== */
  .aa-datepicker--range .aa-datepicker__input {
    min-width: 280px;
  }

  .aa-datepicker--range .aa-datepicker__dropdown {
    min-width: 360px;
  }

  /* Double calendar for range */
  .aa-datepicker--range-double {
    display: flex;
    gap: var(--adlaire-space-4);
  }

  /* ========================================
     Dark Mode Support
     ======================================== */
  @media (prefers-color-scheme: dark) {
    .aa-datepicker__input {
      background-color: var(--adlaire-color-neutral-800);
      border-color: var(--adlaire-color-neutral-700);
    }

    .aa-datepicker__input:hover {
      border-color: var(--adlaire-color-primary);
    }

    .aa-datepicker__input:disabled {
      background-color: var(--adlaire-color-neutral-900);
    }

    .aa-datepicker__dropdown {
      background-color: var(--adlaire-color-neutral-800);
      border-color: var(--adlaire-color-neutral-700);
    }

    .aa-datepicker__nav-button:hover {
      background-color: var(--adlaire-color-neutral-700);
    }

    .aa-datepicker__day:hover:not(:disabled):not(.aa-datepicker__day--disabled) {
      background-color: var(--adlaire-color-neutral-700);
    }

    .aa-datepicker__day--in-range {
      background-color: var(--adlaire-color-neutral-700);
    }

    .aa-datepicker__month-select,
    .aa-datepicker__year-select {
      background-color: var(--adlaire-color-neutral-900);
      border-color: var(--adlaire-color-neutral-700);
    }

    .aa-datepicker__month-select:hover,
    .aa-datepicker__year-select:hover {
      border-color: var(--adlaire-color-primary);
    }

    .aa-datepicker__footer {
      border-top-color: var(--adlaire-color-neutral-700);
    }

    .aa-datepicker__clear-button:hover {
      background-color: var(--adlaire-color-neutral-700);
    }
  }

  /* Dark mode class */
  [data-theme="dark"] .aa-datepicker__input {
    background-color: var(--adlaire-color-neutral-800);
    border-color: var(--adlaire-color-neutral-700);
  }

  [data-theme="dark"] .aa-datepicker__input:hover {
    border-color: var(--adlaire-color-primary);
  }

  [data-theme="dark"] .aa-datepicker__input:disabled {
    background-color: var(--adlaire-color-neutral-900);
  }

  [data-theme="dark"] .aa-datepicker__dropdown {
    background-color: var(--adlaire-color-neutral-800);
    border-color: var(--adlaire-color-neutral-700);
  }

  [data-theme="dark"] .aa-datepicker__nav-button:hover {
    background-color: var(--adlaire-color-neutral-700);
  }

  [data-theme="dark"] .aa-datepicker__day:hover:not(:disabled):not(.aa-datepicker__day--disabled) {
    background-color: var(--adlaire-color-neutral-700);
  }

  [data-theme="dark"] .aa-datepicker__day--in-range {
    background-color: var(--adlaire-color-neutral-700);
  }

  [data-theme="dark"] .aa-datepicker__month-select,
  [data-theme="dark"] .aa-datepicker__year-select {
    background-color: var(--adlaire-color-neutral-900);
    border-color: var(--adlaire-color-neutral-700);
  }

  [data-theme="dark"] .aa-datepicker__month-select:hover,
  [data-theme="dark"] .aa-datepicker__year-select:hover {
    border-color: var(--adlaire-color-primary);
  }

  [data-theme="dark"] .aa-datepicker__footer {
    border-top-color: var(--adlaire-color-neutral-700);
  }

  [data-theme="dark"] .aa-datepicker__clear-button:hover {
    background-color: var(--adlaire-color-neutral-700);
  }

  /* ========================================
     Responsive Mobile Layout
     ======================================== */
  @media (max-width: 480px) {
    .aa-datepicker__dropdown {
      left: 50%;
      transform: translateX(-50%);
      min-width: 300px;
      max-width: calc(100vw - 2rem);
    }

    .aa-datepicker__input {
      min-width: 180px;
    }

    .aa-datepicker--range .aa-datepicker__input {
      min-width: 220px;
    }

    .aa-datepicker__day {
      height: 2.25rem;
      font-size: var(--adlaire-font-size-xs);
    }

    .aa-datepicker__weekday {
      height: 1.75rem;
      font-size: 0.625rem;
    }

    /* Stack double calendar vertically on mobile */
    .aa-datepicker--range-double {
      flex-direction: column;
    }
  }

  /* ========================================
     Accessibility Features
     ======================================== */
  .aa-datepicker__day[aria-selected="true"] {
    font-weight: var(--adlaire-font-weight-bold);
  }

  /* Keyboard focus indicator */
  .aa-datepicker__day:focus-visible {
    outline: 2px solid var(--adlaire-color-primary);
    outline-offset: -2px;
  }

  /* Screen reader only text */
  .aa-datepicker__sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  /* ========================================
     Reduced Motion Support
     ======================================== */
  @media (prefers-reduced-motion: reduce) {
    .aa-datepicker__input,
    .aa-datepicker__day,
    .aa-datepicker__nav-button,
    .aa-datepicker__today-button,
    .aa-datepicker__clear-button,
    .aa-datepicker__month-select,
    .aa-datepicker__year-select {
      transition: none;
    }
  }

  /* ========================================
     Print Styles
     ======================================== */
  @media print {
    .aa-datepicker__dropdown {
      display: none !important;
    }

    .aa-datepicker__input {
      border: 1px solid #000;
      background-color: #fff;
      color: #000;
    }
  }
}
